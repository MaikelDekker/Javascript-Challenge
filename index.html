<!DOCTYPE html>
<html>
<head>
<title>Javascript Challenge</title>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
</head>
<body>
    <script src="http://stemwijzer.dvc-icta.nl/data.js"></script>
    <main>
        <button id="startButton">Start</button>
        <article id="question" style="display:none">
            <h1 id="title"></h1>
            <p id="description"></p>
            <button id="agree">Mee eens</button>
            <button id="neither">Geen van beide</button>
            <button id="disagree">Oneens</button><br><br>
            <button id="partiesButton">Wat vinden de partijen</button>
            <div id="partiesList" style="display:none">
                <div id="proParties"><h1>Partijen voor:</h1></div>
                <div id="ambivalentParties"><h1>Partijen tegenstrijdig:</h1></div>
                <div id="contraParties"><h1>Partijen tegen:</h1></div>
            </div>
        </article>
        <h2 id="results" style="display:none"></h2>
    </main>
    <script>
        var partiesCreated = false;
        var question = 0;
        var result = [];
        var proParties = document.getElementById("proParties");
        var ambivalentParties = document.getElementById("ambivalentParties");
        var contraParties = document.getElementById("contraParties");

        if(document.getElementById("startButton").onclick = function()
        {
            document.getElementById("question").style.display = "block";
            document.getElementById("startButton").style.display = "none";
            question = 0;
            LoadQuestion();
        })
        if(document.getElementById("partiesButton").onclick = function(){LoadParties()});
        if(document.getElementById("agree").onclick = function(){NextQuestion("agree")});
        if(document.getElementById("neither").onclick = function(){NextQuestion("neither")});
        if(document.getElementById("disagree").onclick = function(){NextQuestion("disagree")});

        function NextQuestion(string)
        {
            partiesCreated = false;
            if(string == "agree"){
            result.push(question + "a");
            }else if(string == "neither"){
            result.push(question + "b");
            }else if(string == "disagree"){
            result.push(question + "c");
            }
            question++;
            if(question < 7)
            {
                document.getElementById("partiesList").style.display = "none";
                ClearParties();
                LoadQuestion();
            }else
            {
                GetResults();
            }
        }
        function LoadQuestion()
        {
            document.getElementById("title").innerHTML = subjects[question].title;
            document.getElementById("description").innerHTML = subjects[question].statement;
        }
        function LoadParties()
        {
            if(document.getElementById("partiesList").style.display == "none" && partiesCreated == false)
            {
                var parties = subjects[question].parties;
                var counter = 0;
                for(i in parties)
                {
                    counter++;
                    document.getElementById("partiesList").style.display = "flex";
                    var partyId = (parties[counter - 1].name);
                    partyId = partyId.replace(/ /g, "");
                    partyId = partyId.replace("\"\"", "/");                    
                    var party = document.createElement('div');
                    party.innerHTML = "<label id="+partyId + ">" + parties[counter - 1].name + "</label></div>";
                    
                    if(parties[counter - 1].position == "pro")
                    {
                        proParties.appendChild(party);
                    }else if(parties[counter - 1].position == "ambivalent")
                    {
                        ambivalentParties.appendChild(party);
                    }else if(parties[counter - 1].position == "contra")
                    {
                        contraParties.appendChild(party);
                    }
                    var partyDescription = document.createElement('label');
                    partyDescription.id = partyId + "Description";
                    partyDescription.innerHTML = parties[counter - 1].explanation;
                    document.getElementById(partyId).appendChild(partyDescription);
                }
                partiesCreated = true;
            }else if(document.getElementById("partiesList").style.display == "none" && partiesCreated == true)
            {
                document.getElementById("partiesList").style.display = "flex";
            }else if(document.getElementById("partiesList").style.display == "flex")
            {
                document.getElementById("partiesList").style.display = "none";
            }
        }
        function ClearParties()
        {
            while(proParties.lastChild)
            {
                proParties.removeChild(proParties.lastChild)
            }
            while(ambivalentParties.lastChild)
            {
                ambivalentParties.removeChild(ambivalentParties.lastChild)
            }
            while(contraParties.lastChild)
            {
                contraParties.removeChild(contraParties.lastChild)
            }
        }
        function GetResults()
        {
            document.getElementById("question").style.display = "none";
            var results = document.getElementById("results");
            results.style.display = "block";
            results.innerHTML = result;
        }
    </script>
</body>
</html>
<link rel="stylesheet" type="text/css" href="style.css">